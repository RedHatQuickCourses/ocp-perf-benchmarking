<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ingress Controller Benchmarking with ingress-perf :: OpenShift performance benchmarking guide</title>
    <link rel="prev" href="section2.html">
    <link rel="next" href="../chapter5/index.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">OpenShift performance benchmarking guide</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/ocp-perf-benchmarking/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ocp-perf-benchmarking" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">OpenShift performance benchmarking guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment Setup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter1/index.html">Introduction to Performance Benchmarking</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section1.html">Kubernetes/OpenShift performance landscape</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter2/index.html">Monitoring OpenShift Performance with the Built-in Stack</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/section1.html">Hands-On Lab: Exploring the OpenShift Monitoring Stack</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter3/index.html">Overview of Benchmarking Suites</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section1.html">Kubernetes-native benchmarking tools</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Understanding Openshift Networking</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section1.html">Understanding OVN-Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.html">Network Performance Testing with k8s-netperf</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="section3.html">Ingress Controller Benchmarking and Analysis</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter5/index.html">Control Plane and Scalability Testing with kube-burner</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter5/section1.html">Configuring kube-burner jobs to simulate cluster churn</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter5/section2.html">Measuring Control Plane Responsiveness</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter5/section3.html">Hands-on with kube-burner</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter6/index.html">Final Review and Key Takeaways</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter6/section1.html">Final review</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/appendix.html">Appendix and References</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">OpenShift performance benchmarking guide</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">OpenShift performance benchmarking guide</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">OpenShift performance benchmarking guide</a></li>
    <li><a href="index.html">Understanding Openshift Networking</a></li>
    <li><a href="section3.html">Ingress Controller Benchmarking and Analysis</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Ingress Controller Benchmarking with ingress-perf</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://github.com/cloud-bulldozer/ingress-perf/">Ingress-perf</a> is an open-source tool aimed at deploying and orchestrating performance benchmarks over the ingress stack of the given OpenShift cluster. Written in golang, this tool makes straight forward to define different test scenarios by using a simple YAML configuration file.</p>
</div>
<div class="paragraph">
<p>Same as k8s-netperf, this tool receives periodic updates with bugfixes and enhancements, as it&#8217;s currently used to detect potential performance regressions in new OpenShift versions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_starting_with_ingress_perf"><a class="anchor" href="#_starting_with_ingress_perf"></a>Starting with Ingress-perf</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_1_downloading_latest_stable_version"><a class="anchor" href="#_1_downloading_latest_stable_version"></a>1. Downloading latest stable version</h3>
<div class="paragraph">
<p>Download the latest stable release for your operating system and architecture from the <a href="https://github.com/cloud-bulldozer/ingress-perf/releases/latest">GitHub releases page</a>.</p>
</div>
<div class="paragraph">
<p>For example, from the lab bastion host (Linux and amd64 architecture), you can download the v0.6.0 stable release with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -L https://github.com/cloud-bulldozer/ingress-perf/releases/download/v0.6.0/ingress-perf-Linux-v0.6.0-x86_64.tar.gz -o ingress-perf.tar.gz
tar -xzf ingress-perf.tar.gz ingress-perf</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you can move the ingress-perf binary to a directory in your path, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sudo mv ingress-perf /usr/local/bin/</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_2_configuration"><a class="anchor" href="#_2_configuration"></a>2. Configuration</h3>
<div class="paragraph">
<p>As mentioned before, ingress-perf uses a simple YAML configuration file to define the test scenarios. They are documented at the <a href="https://github.com/cloud-bulldozer/ingress-perf/?tab=readme-ov-file#reference">project&#8217;s site</a></p>
</div>
<div class="paragraph">
<p>This configuration contains a list of scenarios that Ingress-perf uses to deploy the required assets: backends (a nginx pod that serves static content) and <a href="https://github.com/cloud-bulldozer/ingress-perf?tab=readme-ov-file#supported-tools">load tools</a>.</p>
</div>
<div class="paragraph">
<p>Once these assets are deployed, ingress-perf will run the benchmarks with specified configuration, like the http termination, test concurrency, number of connections, etc.</p>
</div>
</div>
<div class="sect2">
<h3 id="_3_running_ingress_perf"><a class="anchor" href="#_3_running_ingress_perf"></a>3. Running ingress-perf</h3>
<div class="paragraph">
<p>Run Ingress-perf with this basic <code>ingress-perf.yaml</code> configuration file to run two benchmark scenarios with similar parameters, but different termination types: http and edge.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cat &gt; ingress-perf.yaml &lt;&lt;EOF
- termination: http
  connections: 200
  samples: 2
  duration: 2m
  path: /1024.html
  concurrency: 18
  tool: wrk
  serverReplicas: 45
  requestTimeout: 10s

- termination: edge
  connections: 200
  samples: 2
  duration: 2m
  path: /1024.html
  concurrency: 1
  tool: wrk
  serverReplicas: 45
EOF</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then run ingress-perf with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ingress-perf run -c ingress-perf.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output will be similar to this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ingress-perf run -c ingress-perf.yaml</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">time="2025-11-28 15:16:20" level=info msg="Running ingress-perf (heads/v0.6.0@e06373946c0c939445d3b94d871d52ccd8c7e8c4) with uuid f1bd5953-698b-4b48-88ba-c79bd6f783c8" file="ingress-perf.go:62"
time="2025-11-28 15:16:20" level=info msg="Creating local indexer" file="runner.go:87"
time="2025-11-28 15:16:24" level=info msg="HAProxy version: haproxy28-2.8.10-1.rhaos4.17.el9.x86_64" file="runner.go:170"
time="2025-11-28 15:16:24" level=info msg="Deploying benchmark assets" file="runner.go:262"
time="2025-11-28 15:16:26" level=info msg="Running test 1/2" file="runner.go:177"
time="2025-11-28 15:16:26" level=info msg="Tool:wrk termination:http servers:45 concurrency:18 procs:1 connections:200 duration:2m0s http2:false" file="runner.go:178"
time="2025-11-28 15:16:27" level=info msg="Waiting for replicas from deployment nginx in ns ingress-perf to be ready" file="runner.go:403"
time="2025-11-28 15:16:29" level=info msg="Waiting for replicas from deployment ingress-perf-client in ns ingress-perf to be ready" file="runner.go:403"
time="2025-11-28 15:16:35" level=info msg="Running sample 1/2: 2m0s" file="exec.go:102"
time="2025-11-28 15:21:03" level=info msg="Scenario summary http: Rps=90731 avgLatency=42ms P95Latency=46ms timeouts=0 http_errors=0" file="exec.go:157"
time="2025-11-28 15:21:03" level=info msg="Running test 2/2" file="runner.go:177"
time="2025-11-28 15:21:03" level=info msg="Tool:wrk termination:edge servers:45 concurrency:1 procs:1 connections:200 duration:2m0s http2:false" file="runner.go:178"
time="2025-11-28 15:21:03" level=info msg="Waiting for replicas from deployment ingress-perf-client in ns ingress-perf to be ready" file="runner.go:403"
time="2025-11-28 15:21:04" level=info msg="Running sample 1/2: 2m0s" file="exec.go:102"
time="2025-11-28 15:21:03" level=info msg="Scenario summary http: Rps=90731 avgLatency=42ms P95Latency=46ms timeouts=0 http_errors=0" file="exec.go:157"
time="2025-11-28 15:21:03" level=info msg="Running test 2/2" file="runner.go:177"
time="2025-11-28 15:21:03" level=info msg="Tool:wrk termination:edge servers:45 concurrency:1 procs:1 connections:200 duration:2m0s http2:false" file="runner.go:178"
time="2025-11-28 15:21:03" level=info msg="Waiting for replicas from deployment ingress-perf-client in ns ingress-perf to be ready" file="runner.go:403"
time="2025-11-28 15:21:04" level=info msg="Running sample 1/2: 2m0s" file="exec.go:102"
time="2025-11-28 15:23:07" level=info msg="edge: Rps=67920 avgLatency=3ms P95Latency=4ms" file="exec.go:149"
time="2025-11-28 15:23:07" level=info msg="Running sample 2/2: 2m0s" file="exec.go:102"
time="2025-11-28 15:25:10" level=info msg="edge: Rps=66230 avgLatency=3ms P95Latency=4ms" file="exec.go:149"
time="2025-11-28 15:25:10" level=info msg="Scenario summary edge: Rps=67075 avgLatency=3ms P95Latency=4ms timeouts=0 http_errors=0" file="exec.go:157"
time="2025-11-28 15:25:10" level=info msg="File output/f1bd5953-698b-4b48-88ba-c79bd6f783c8.json created with 3 documents" file="runner.go:234"
time="2025-11-28 15:25:10" level=info msg="Cleaning up resources" file="runner.go:239"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The metrics</p>
</div>
<div class="paragraph">
<p>Note that ingress-perf cleans up the resources after the benchmarks are complete, so you don&#8217;t need to clean up manually.</p>
</div>
</div>
<div class="sect2">
<h3 id="_4_indexing_the_results"><a class="anchor" href="#_4_indexing_the_results"></a>4. Indexing the results</h3>
<div class="paragraph">
<p>If no indexer is specified, ingress-perf will store the results in the local directory specified by <code>--output-dir</code>, by default <code>output</code>.</p>
</div>
<div class="paragraph">
<p>However, you can also index the results in a remote ElasticSearch/OpenSearch instance with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ingress-perf run -c ingress-perf.yaml --es-server=https://your.es-endpoint.com --es-index=ingress-perf</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check out the <code>ingress-perf run --help</code> for more info about the allowed flags.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="section2.html">Network Performance Testing with k8s-netperf</a></span>
  <span class="next"><a href="../chapter5/index.html">Control Plane and Scalability Testing with kube-burner</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
