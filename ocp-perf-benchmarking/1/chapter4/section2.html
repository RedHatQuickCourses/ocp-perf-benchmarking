<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Network performance testing with k8s-netperf :: OpenShift performance benchmarking guide</title>
    <link rel="prev" href="section1.html">
    <link rel="next" href="section3.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">OpenShift performance benchmarking guide</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/ocp-perf-benchmarking/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ocp-perf-benchmarking" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">OpenShift performance benchmarking guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment Setup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter1/index.html">Introduction to Performance Benchmarking</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section1.html">Kubernetes/OpenShift performance landscape</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter2/index.html">Monitoring OpenShift Performance with the Built-in Stack</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/section1.html">Hands-on lab: Exploring the OpenShift monitoring stack</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter3/index.html">Overview of Benchmarking Suites</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section1.html">Kubernetes-native benchmarking tools</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Understanding Openshift Networking</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section1.html">Understanding OVN-Kubernetes</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="section2.html">Network Performance Testing with k8s-netperf</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section3.html">Ingress Controller Benchmarking and Analysis</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter5/index.html">Control Plane and Scalability Testing with kube-burner</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter5/section1.html">Configuring kube-burner jobs to simulate cluster churn</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter5/section2.html">Measuring Control Plane Responsiveness</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter5/section3.html">Hands-on with kube-burner</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../chapter6/index.html">Final Review and Key Takeaways</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">OpenShift performance benchmarking guide</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">OpenShift performance benchmarking guide</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">OpenShift performance benchmarking guide</a></li>
    <li><a href="index.html">Understanding Openshift Networking</a></li>
    <li><a href="section2.html">Network Performance Testing with k8s-netperf</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Network performance testing with k8s-netperf</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://github.com/cloud-bulldozer/k8s-netperf/">k8s-netperf</a> is an open-source tool designed to make it easy to run networking performance tests against your OpenShift clusters. It&#8217;s built by the team at Red Hat who contribute to the <a href="https://github.com/cloud-bulldozer">cloud-bulldozer</a> organization, and it&#8217;s a powerful and simple way to understand how your network is performing and to identify any potential bottlenecks.</p>
</div>
<div class="paragraph">
<p>Red Hat OpenShift&#8217;s development team is constantly updating and improving its source code and the Kernel networking data-path is part of that source code! In order to ensure the OpenShift network performance stays lightning fast, we have k8s-netperf running constantly on new releases of OpenShift in our pipeline.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started_with_k8s_netperf"><a class="anchor" href="#_getting_started_with_k8s_netperf"></a>Getting started with k8s-netperf</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Getting started with k8s-netperf is a straightforward process. Here&#8217;s a quick guide to get you up and running:</p>
</div>
<div class="sect2">
<h3 id="_installation"><a class="anchor" href="#_installation"></a>Installation</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -Ls https://raw.githubusercontent.com/cloud-bulldozer/k8s-netperf/refs/heads/main/hack/install.sh | sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>Validate the installation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">k8s-netperf -h</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_node_labeling_optional"><a class="anchor" href="#_node_labeling_optional"></a>Node labeling (optional)</h3>
<div class="paragraph">
<p>k8s-netperf schedules a client and a server pod in your OpenShift cluster to run the network throughput and latency tests. Allowing for node labeling allows the user to control which nodes the network performance tests run on - for example to not cross regions or availability zones, which could lead to higher latency. To also ensure that these pods land on the correct nodes, you use node labels.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get node</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">NAME                            STATUS   ROLES                  AGE   VERSION
control-plane-cluster-vjm62-1   Ready    control-plane,master   47h   v1.31.7
control-plane-cluster-vjm62-2   Ready    control-plane,master   47h   v1.31.7
control-plane-cluster-vjm62-3   Ready    control-plane,master   47h   v1.31.7
worker-cluster-vjm62-1          Ready    worker                 47h   v1.31.7
worker-cluster-vjm62-2          Ready    worker                 47h   v1.31.7</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc label node worker-cluster-vjm62-1 netperf=client
oc label node worker-cluster-vjm62-2 netperf=server</code></pre>
</div>
</div>
<div class="paragraph">
<p>If for some reason you want to place the client and server pods on the same node you can use the <code>--local</code> flag.</p>
</div>
</div>
<div class="sect2">
<h3 id="_namespace_and_service_account_setup_optional"><a class="anchor" href="#_namespace_and_service_account_setup_optional"></a>Namespace and service account setup (optional)</h3>
<div class="paragraph">
<p>You&#8217;ll need a dedicated namespace and service account for k8s-netperf. You can create them with the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc create ns netperf
oc create sa -n netperf netperf</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you plan to run tests with hostNetwork enabled, you&#8217;ll need to grant the netperf service account additional permissions.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_your_first_test"><a class="anchor" href="#_running_your_first_test"></a>Running your first test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the setup complete, you&#8217;re now ready to run your first network performance test. k8s-netperf offers a wide range of options to customize your tests. Here&#8217;s a basic example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cat &gt; netperf.yml &lt;&lt;EOF
tests:
- TCPStreamSmall:
  parallelism: 1
  profile: "TCP_STREAM"
  duration: 30
  samples: 2
  messagesize: 64

- UDPStreamSmall:
  parallelism: 1
  profile: "UDP_STREAM"
  duration: 30
  samples: 2
  messagesize: 64
EOF</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s run it with the <code>-all</code> flag that runs both hostNet and podNetwork scenarios. This comparison is very useful to understand the CNI overhead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">k8s-netperf --all</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">INFO[2025-12-03 10:06:53] Starting k8s-netperf (0.1.34@664f2cc67082b9dcd5a07f6d01b195ca6ad507c4)
INFO[2025-12-03 10:06:53] üìí Reading netperf.yml file.
INFO[2025-12-03 10:06:53] üìí Reading netperf.yml file - using ConfigV2 Method.
INFO[2025-12-03 10:58:23] üî¨ prometheus discovered at openshift-monitoring
INFO[2025-12-03 10:07:04] üî® Creating namespace: netperf
INFO[2025-12-03 10:07:04] üî® Creating service account: netperf
WARN[2025-12-03 10:07:04] ‚ö†Ô∏è  No zone label
WARN[2025-12-03 10:07:04] ‚ö†Ô∏è  Single node per zone and/or no zone labels
INFO[2025-12-03 10:07:04] üöÄ Creating service for iperf-service in namespace netperf
INFO[2025-12-03 10:07:04] üöÄ Creating service for uperf-service in namespace netperf
INFO[2025-12-03 10:07:04] üöÄ Creating service for netperf-service in namespace netperf
INFO[2025-12-03 10:07:05] üöÄ Starting Deployment for: client-host in namespace: netperf
INFO[2025-12-03 10:07:05] ‚è∞ Checking for client-host Pods to become ready...
INFO[2025-12-03 10:07:22] Looking for pods with label role=host-client
INFO[2025-12-03 10:07:22] üöÄ Starting Deployment for: client-across in namespace: netperf
INFO[2025-12-03 10:07:22] ‚è∞ Checking for client-across Pods to become ready...
INFO[2025-12-03 10:07:24] Looking for pods with label role=client-across
INFO[2025-12-03 10:07:24] üöÄ Starting Deployment for: server-host in namespace: netperf
INFO[2025-12-03 10:07:24] ‚è∞ Checking for server-host Pods to become ready...
INFO[2025-12-03 10:07:35] Looking for pods with label role=host-server
INFO[2025-12-03 10:07:35] üöÄ Starting Deployment for: server in namespace: netperf
INFO[2025-12-03 10:07:35] ‚è∞ Checking for server Pods to become ready...
INFO[2025-12-03 10:07:39] Looking for pods with label role=server
INFO[2025-12-03 10:07:44] üóíÔ∏è  Running netperf TCP_STREAM (service false) for 30s
INFO[2025-12-03 10:08:16] üóíÔ∏è  Running netperf TCP_STREAM (service false) for 30s
INFO[2025-12-03 10:08:48] üóíÔ∏è  Running netperf TCP_STREAM (service false) for 30s
INFO[2025-12-03 10:09:20] üóíÔ∏è  Running netperf TCP_STREAM (service false) for 30s
INFO[2025-12-03 10:13:06] üóíÔ∏è  Running netperf UDP_STREAM (service false) for 30s
INFO[2025-12-03 10:13:39] üóíÔ∏è  Running netperf UDP_STREAM (service false) for 30s
INFO[2025-12-03 10:14:11] üóíÔ∏è  Running netperf UDP_STREAM (service false) for 30s
INFO[2025-12-03 10:14:43] üóíÔ∏è  Running netperf UDP_STREAM (service false) for 30s
+-------------------+---------+------------+-------------+--------------+---------+-----------------+----------+-------------+--------------+-------+-----------+----------+---------+-------------------+------------------------------+
|    RESULT TYPE    | DRIVER  |  SCENARIO  | PARALLELISM | HOST NETWORK | SERVICE | EXTERNAL SERVER | UDN INFO | BRIDGE INFO | MESSAGE SIZE | BURST | SAME NODE | DURATION | SAMPLES |     AVG VALUE     |   95% CONFIDENCE INTERVAL    |
+-------------------+---------+------------+-------------+--------------+---------+-----------------+----------+-------------+--------------+-------+-----------+----------+---------+-------------------+------------------------------+
| üìä Stream Results | netperf | TCP_STREAM | 1           | true         | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 240.416000 (Mb/s) | 234.638902-246.193098 (Mb/s) |
| üìä Stream Results | netperf | TCP_STREAM | 1           | false        | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 221.214000 (Mb/s) | 215.625211-226.802789 (Mb/s) |
| üìä Stream Results | netperf | UDP_STREAM | 1           | true         | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 42.238000 (Mb/s)  | 41.693902-42.782098 (Mb/s)   |
| üìä Stream Results | netperf | UDP_STREAM | 1           | false        | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 40.906000 (Mb/s)  | 40.186660-41.625340 (Mb/s)   |
+-------------------+---------+------------+-------------+--------------+---------+-----------------+----------+-------------+--------------+-------+-----------+----------+---------+-------------------+------------------------------+
+---------------------+---------+------------+-------------+--------------+---------+-----------------+----------+-------------+--------------+-------+-----------+----------+---------+------------+
|        TYPE         | DRIVER  |  SCENARIO  | PARALLELISM | HOST NETWORK | SERVICE | EXTERNAL SERVER | UDN INFO | BRIDGE INFO | MESSAGE SIZE | BURST | SAME NODE | DURATION | SAMPLES | AVG VALUE  |
+---------------------+---------+------------+-------------+--------------+---------+-----------------+----------+-------------+--------------+-------+-----------+----------+---------+------------+
| TCP Retransmissions | netperf | TCP_STREAM | 1           | true         | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 115.600000 |
| TCP Retransmissions | netperf | TCP_STREAM | 1           | false        | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 126.600000 |
| UDP Loss Percent    | netperf | UDP_STREAM | 1           | true         | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 1.436027   |
| UDP Loss Percent    | netperf | UDP_STREAM | 1           | false        | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 0.434704   |
+---------------------+---------+------------+-------------+--------------+---------+-----------------+----------+-------------+--------------+-------+-----------+----------+---------+------------+
INFO[2025-12-03 10:18:29] Cleaning resources created by k8s-netperf
INFO[2025-12-03 10:18:29] ‚è∞ Waiting for netperf Namespace to be deleted...</code></pre>
</div>
</div>
<div class="paragraph">
<p>As expected, the host network results (direct connectivity between hosts) where slightly better than the pod network ones (pod to pod connectivity through the CNI), though the difference is perfectly within the expected range. k8s-netperf will alert (and exit with error code 1) if the difference between host network and pod network results is significant (default alert threshold is 10%, can be adjusted though the <code>--tcp-tolerance</code> flag).</p>
</div>
<div class="paragraph">
<p>This command will run a comprehensive set of tests, including TCP and UDP stream tests, as well as request/response tests.</p>
</div>
<div class="paragraph">
<p>Here are some of the most useful command-line options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--across</code>: Forces the client and server pods to be scheduled across different availability zones.</p>
</li>
<li>
<p><code>--json</code>: Outputs the test results in JSON format, which is great for parsing with tools like jq.</p>
</li>
<li>
<p><code>--clean=true</code>: Deletes all of the resources created by k8s-netperf after the tests are complete.</p>
</li>
<li>
<p><code>--metrics</code>: Displays Prometheus metrics in the standard output.</p>
</li>
<li>
<p><code>--iperf</code>: Uses iperf3 as the load driver for stream tests.</p>
</li>
<li>
<p><code>--uperf</code>: Uses uperf as the load driver for stream tests.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_indexing_the_results"><a class="anchor" href="#_indexing_the_results"></a>Indexing the results</h3>
<div class="paragraph">
<p>If no indexer is specified, k8s-netperf will store the results in a result-$id.csv file in the local directory.</p>
</div>
<div class="paragraph">
<p>However, you can also index the results in a remote ElasticSearch/OpenSearch instance following the next steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get ElasticSearch password:</p>
<div class="literalblock">
<div class="content">
<pre>ES_PASSWORD=$(oc get secret elasticsearch-es-elastic-user -n openshift-logging -o jsonpath='{.data.elastic}' | base64 -d)</pre>
</div>
</div>
</li>
<li>
<p>Get ElasticSearch route URL:</p>
<div class="literalblock">
<div class="content">
<pre>ES_INSTANCE=$(oc get route elasticsearch-route -n openshift-logging -o jsonpath="https://elastic:${ES_PASSWORD}@{.spec.host}")</pre>
</div>
</div>
</li>
<li>
<p>Validate the ElasticSearch credentials:</p>
<div class="literalblock">
<div class="content">
<pre>curl -k $ES_INSTANCE</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>{
  "name" : "elasticsearch-es-default-0",
  "cluster_name" : "elasticsearch",
  "cluster_uuid" : "gfP33bmwQ82UMWI2btj2OQ",
  "version" : {
    "number" : "8.15.0",
    "build_flavor" : "default",
    "build_type" : "docker",
    "build_hash" : "1a77947f34deddb41af25e6f0ddb8e830159c179",
    "build_date" : "2024-08-05T10:05:34.233336849Z",
    "build_snapshot" : false,
    "lucene_version" : "9.11.1",
    "minimum_wire_compatibility_version" : "7.17.0",
    "minimum_index_compatibility_version" : "7.0.0"
  },
  "tagline" : "You Know, for Search"
}</pre>
</div>
</div>
</li>
<li>
<p>Run test with the following command:</p>
<div class="literalblock">
<div class="content">
<pre>k8s-netperf --all --search=${ES_INSTANCE} --index=k8s-netperf</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>INFO[2025-12-03 11:06:05] Starting k8s-netperf (roce2@e2988034e0f9dd4e2a59f131f6ae7866b12fd6de)
INFO[2025-12-03 11:06:05] üìí Reading netperf.yml file.
INFO[2025-12-03 11:06:05] üìí Reading netperf.yml file - using ConfigV2 Method.
INFO[2025-12-03 11:06:05] üî¨ prometheus discovered at openshift-monitoring
INFO[2025-12-03 11:06:05] üî® Creating namespace: netperf
INFO[2025-12-03 11:06:05] üî® Creating service account: netperf
WARN[2025-12-03 11:06:05] ‚ö†Ô∏è  No zone label
WARN[2025-12-03 11:06:05] ‚ö†Ô∏è  Single node per zone and/or no zone labels
INFO[2025-12-03 11:06:05] üöÄ Creating service for netperf-service in namespace netperf
INFO[2025-12-03 11:06:06] üöÄ Starting Deployment for: client-host in namespace: netperf
INFO[2025-12-03 11:06:06] ‚è∞ Checking for client-host Pods to become ready...
INFO[2025-12-03 11:06:08] Looking for pods with label role=host-client
INFO[2025-12-03 11:06:08] üöÄ Starting Deployment for: client-across in namespace: netperf
INFO[2025-12-03 11:06:08] ‚è∞ Checking for client-across Pods to become ready...
INFO[2025-12-03 11:06:10] Looking for pods with label role=client-across
INFO[2025-12-03 11:06:10] üöÄ Starting Deployment for: server-host in namespace: netperf
INFO[2025-12-03 11:06:10] ‚è∞ Checking for server-host Pods to become ready...
INFO[2025-12-03 11:06:12] Looking for pods with label role=host-server
INFO[2025-12-03 11:06:12] üöÄ Starting Deployment for: server in namespace: netperf
INFO[2025-12-03 11:06:12] ‚è∞ Checking for server Pods to become ready...
INFO[2025-12-03 11:06:14] Looking for pods with label role=server
INFO[2025-12-03 11:06:19] üóíÔ∏è  Running netperf TCP_STREAM (service false) for 30s
INFO[2025-12-03 11:06:51] üóíÔ∏è  Running netperf TCP_STREAM (service false) for 30s
INFO[2025-12-03 11:07:24] üóíÔ∏è  Running netperf TCP_STREAM (service false) for 30s
INFO[2025-12-03 11:07:56] üóíÔ∏è  Running netperf TCP_STREAM (service false) for 30s
INFO[2025-12-03 11:08:28] üóíÔ∏è  Running netperf UDP_STREAM (service false) for 30s
INFO[2025-12-03 11:09:00] üóíÔ∏è  Running netperf UDP_STREAM (service false) for 30s
INFO[2025-12-03 11:09:33] üóíÔ∏è  Running netperf UDP_STREAM (service false) for 30s
INFO[2025-12-03 11:10:05] üóíÔ∏è  Running netperf UDP_STREAM (service false) for 30s
INFO[2025-12-03 11:10:38] üìÅ Creating indexer: elastic
INFO[2025-12-03 11:10:38] Connected to : https://elastic:pcFY8NF1mc9cY1GJnqi4MO8v@elasticsearch-route-openshift-logging.apps.cluster-vjm62.dynamic.redhatworkshops.io
INFO[2025-12-03 11:10:38] Indexing [4] documents in k8s-netperf with UUID 8281a404-740c-4091-9548-4c6dc7bc89ac
INFO[2025-12-03 11:10:38] Indexing finished in 100ms: created=4
+-------------------+---------+------------+-------------+--------------+---------+-----------------+----------+-------------+--------------+-------+-----------+----------+---------+-------------------+------------------------------+
|    RESULT TYPE    | DRIVER  |  SCENARIO  | PARALLELISM | HOST NETWORK | SERVICE | EXTERNAL SERVER | UDN INFO | BRIDGE INFO | MESSAGE SIZE | BURST | SAME NODE | DURATION | SAMPLES |     AVG VALUE     |   95% CONFIDENCE INTERVAL    |
+-------------------+---------+------------+-------------+--------------+---------+-----------------+----------+-------------+--------------+-------+-----------+----------+---------+-------------------+------------------------------+
| üìä Stream Results | netperf | TCP_STREAM | 1           | true         | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 217.280000 (Mb/s) | 114.867990-319.692010 (Mb/s) |
| üìä Stream Results | netperf | TCP_STREAM | 1           | false        | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 216.245000 (Mb/s) | 182.255902-250.234098 (Mb/s) |
| üìä Stream Results | netperf | UDP_STREAM | 1           | true         | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 41.280000 (Mb/s)  | 36.324580-46.235420 (Mb/s)   |
| üìä Stream Results | netperf | UDP_STREAM | 1           | false        | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 39.765000 (Mb/s)  | 30.807126-48.722874 (Mb/s)   |
+-------------------+---------+------------+-------------+--------------+---------+-----------------+----------+-------------+--------------+-------+-----------+----------+---------+-------------------+------------------------------+
+---------------------+---------+------------+-------------+--------------+---------+-----------------+----------+-------------+--------------+-------+-----------+----------+---------+------------+
|        TYPE         | DRIVER  |  SCENARIO  | PARALLELISM | HOST NETWORK | SERVICE | EXTERNAL SERVER | UDN INFO | BRIDGE INFO | MESSAGE SIZE | BURST | SAME NODE | DURATION | SAMPLES | AVG VALUE  |
+---------------------+---------+------------+-------------+--------------+---------+-----------------+----------+-------------+--------------+-------+-----------+----------+---------+------------+
| TCP Retransmissions | netperf | TCP_STREAM | 1           | true         | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 153.500000 |
| TCP Retransmissions | netperf | TCP_STREAM | 1           | false        | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 67.500000  |
| UDP Loss Percent    | netperf | UDP_STREAM | 1           | true         | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 0.943826   |
| UDP Loss Percent    | netperf | UDP_STREAM | 1           | false        | false   | false           |          |             | 64           | 0     | false     | 30       | 2       | 0.316821   |
+---------------------+---------+------------+-------------+--------------+---------+-----------------+----------+-------------+--------------+-------+-----------+----------+---------+------------+
INFO[2025-12-03 11:10:38] Cleaning resources created by k8s-netperf
INFO[2025-12-03 11:10:38] ‚è∞ Waiting for netperf Namespace to be deleted...</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_usage"><a class="anchor" href="#_advanced_usage"></a>Advanced usage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>k8s-netperf also supports more advanced use cases, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Testing with <strong>Virtual Machines</strong>: If you&#8217;re using OpenShift CNV, you can run network performance tests between virtual machines.</p>
</li>
<li>
<p>Using a <strong>Linux Bridge Interface</strong>: The <code>--bridge</code> option allows you to test network performance over a Linux bridge interface.</p>
</li>
<li>
<p>Integrating with <strong>Prometheus</strong>: You can use the <code>--prom</code> option to specify a Prometheus URL for scraping metrics.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interpreting_the_results"><a class="anchor" href="#_interpreting_the_results"></a>Interpreting the results</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The output of k8s-netperf will vary depending on the tests you run. However, you&#8217;ll typically see metrics such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Throughput: The amount of data that can be transferred over the network in a given amount of time.</p>
</li>
<li>
<p>Latency: The time it takes for a packet to travel from the client to the server and back.</p>
</li>
<li>
<p>Packet Loss: The percentage of packets that are lost during transmission.</p>
</li>
<li>
<p>CPU Usage: The amount of CPU that is consumed by the client and server pods during the tests.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By analyzing these metrics, you can gain valuable insights into the performance of your OpenShift network. You can use this information to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Identify and troubleshoot network bottlenecks.</p>
</li>
<li>
<p>Compare the performance and overhead of different CNI plugins.</p>
</li>
<li>
<p>Optimize your network configuration for better performance, like increased MTU.</p>
</li>
<li>
<p>Ensure that your network can handle the demands of your applications.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion"><a class="anchor" href="#_conclusion"></a>Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>k8s-netperf is an essential tool for any engineer who is serious about OpenShift network performance. It&#8217;s easy to use, yet powerful enough to provide you with the insights you need to optimize your network and ensure that your applications are running at their best.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="section1.html">Understanding OVN-Kubernetes</a></span>
  <span class="next"><a href="section3.html">Ingress Controller Benchmarking and Analysis</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
