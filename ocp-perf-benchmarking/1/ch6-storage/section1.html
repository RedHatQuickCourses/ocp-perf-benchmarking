<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Storage performance testing with k8s-io :: OpenShift performance benchmarking guide</title>
    <link rel="prev" href="index.html">
    <link rel="next" href="../ch7-regression/index.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">OpenShift performance benchmarking guide</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/ocp-perf-benchmarking/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ocp-perf-benchmarking" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">OpenShift performance benchmarking guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment Setup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch1-intro/index.html">Introduction to Performance Benchmarking</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch1-intro/section1.html">Kubernetes/OpenShift performance landscape</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch2-monitoring/index.html">Monitoring OpenShift Performance with the Built-in Stack</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch2-monitoring/section1.html">Hands-on lab: Exploring the OpenShift monitoring stack</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch3-bench/index.html">Overview of Benchmarking Suites</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch3-bench/section1.html">Kubernetes-native benchmarking tools</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch4-kubeburner/index.html">Control Plane and Scalability Testing with kube-burner</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch4-kubeburner/section1.html">Measuring Control Plane Responsiveness</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch4-kubeburner/section2.html">Configuring kube-burner jobs to simulate cluster churn</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch4-kubeburner/section3.html">Hands-on with kube-burner</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch5-network/index.html">Understanding Openshift Networking</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch5-network/section1.html">Understanding OVN-Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch5-network/section2.html">Network Performance Testing with k8s-netperf</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch5-network/section3.html">Ingress Controller Benchmarking and Analysis</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Storage benchmarking</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="section1.html">Storage performance testing with k8s-IO</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch7-regression/index.html">Automatic performance regression analysis</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch7-regression/section1.html">Hands-on with Orion</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../ch8-final/index.html">Final Review and Key Takeaways</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">OpenShift performance benchmarking guide</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">OpenShift performance benchmarking guide</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">OpenShift performance benchmarking guide</a></li>
    <li><a href="index.html">Storage benchmarking</a></li>
    <li><a href="section1.html">Storage performance testing with k8s-IO</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Storage performance testing with k8s-io</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>K8s-io is a lightweight Go-based CLI tool for running benchmark workloads on Kubernetes clusters. Unlike operator-based solutions, it provides a simple command-line interface for executing benchmarks without requiring cluster-wide operator deployments. It supports multiple benchmark types and reuses existing Jinja templates from the benchmark-operator project.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supported_workloads"><a class="anchor" href="#_supported_workloads"></a>Supported workloads</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>FIO: Distributed I/O benchmark using FIO (Flexible I/O Tester)</p>
</li>
<li>
<p>HammerDB: Database performance benchmark supporting PostgreSQL, MariaDB, and MSSQL</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started_with_k8s_io"><a class="anchor" href="#_getting_started_with_k8s_io"></a>Getting started with k8s-io</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_downloading_and_install_latest_stable_version"><a class="anchor" href="#_downloading_and_install_latest_stable_version"></a>Downloading and install latest stable version</h3>
<div class="paragraph">
<p>Download and install the latest stable release for your operating system and architecture with the command below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -Ls https://raw.githubusercontent.com/jtaleric/k8s-io/refs/heads/main/hack/install.sh | sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>Validate the installation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">k8s-io -h</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration"><a class="anchor" href="#_configuration"></a>Configuration</h3>
<div class="paragraph">
<p>The tool uses YAML configuration files to specify benchmark parameters. Let&#8217;s start with a FIO distributed benchmark configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cat &gt; config-fio.yaml &lt;&lt;EOF
namespace: "benchmark-fio"
workload:
  name: "fio"
  args:
    kind: "pod"
    servers: 2
    samples: 2
    jobs: ["read", "write"]
    bs: ["4KiB", "8KiB"]
    numjobs: [1, 2]
    filesize: "1G"
    prefill: true
EOF</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s take a closer look at each of the fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kind</code>: Pod or virtual machine</p>
</li>
<li>
<p><code>servers</code>: Number of FIO server pods</p>
</li>
<li>
<p><code>samples</code>: Test iterations</p>
</li>
<li>
<p><code>jobs</code>: FIO job types</p>
</li>
<li>
<p><code>bs</code>: Block sizes</p>
</li>
<li>
<p><code>numjobs</code>: FIO processes per pod</p>
</li>
<li>
<p><code>filesize</code>: File size for testing</p>
</li>
<li>
<p><code>prefill</code>: Enable prefill</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s run this simple configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">k8s-io -config config-fio.yaml</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>2025/12/04 11:50:26 Starting K8s-IO benchmark tool...
2025/12/04 11:50:26 Loaded configuration for workload: fio
2025/12/04 11:50:26 Created fio workload
2025/12/04 11:50:26 Creating namespace: benchmark-fio
2025/12/04 11:50:26 Starting fio benchmark...
2025/12/04 11:50:26 Starting FIO distributed benchmark execution...
2025/12/04 11:50:26 Deploying infrastructure...
2025/12/04 11:50:26 Waiting for 2 FIO servers to be ready...
2025/12/04 11:52:01 Waiting for pods: 0/2 ready (selector: app=fio-benchmark-17648670)
2025/12/04 11:52:06 Waiting for pods: 0/2 ready (selector: app=fio-benchmark-17648670)
2025/12/04 11:52:21 Waiting for pods: 1/2 ready (selector: app=fio-benchmark-17648670)
2025/12/04 11:52:26 Waiting for pods: 1/2 ready (selector: app=fio-benchmark-17648670)
2025/12/04 11:52:31 All 2 servers are ready
2025/12/04 11:52:31 Creating hosts configmap...
2025/12/04 11:52:31 Job fio-check-17648670 still running (succeeded: 0, failed: 0, active: 1)
2025/12/04 11:53:31 Job fio-check-17648670 completed successfully
2025/12/04 11:53:31 Running prefill job...
2025/12/04 11:53:31 Job fio-prefill-17648670 still running (succeeded: 0, failed: 0, active: 0)
2025/12/04 11:54:31 Job fio-prefill-17648670 completed successfully
2025/12/04 11:54:31 Prefill completed successfully
2025/12/04 11:54:31 Starting benchmark client...
2025/12/04 11:54:32 Benchmark client started
2025/12/04 11:54:32 Waiting for benchmark to complete...
2025/12/04 11:54:32 Job fio-client-17648670 still running (succeeded: 0, failed: 0, active: 0)
2025/12/04 11:55:32 Job fio-client-17648670 still running (succeeded: 0, failed: 0, active: 1)
2025/12/04 12:51:33 Job fio-client-17648670 completed successfully
2025/12/04 12:51:33 Capturing benchmark results...
Found 16 FIO result(s)

=== FIO Benchmark Results ===
Test ID                          Sample  Job    Hostname     Read IOPS  Read BW (KB/s)  Write IOPS  Write BW (KB/s)  Read Lat P50 (μs)  Read Lat P95 (μs)  Write Lat P50 (μs)  Write Lat P95 (μs)  Runtime (s)
-------                          ------  ---    --------     ---------  -----------     ----------  ------------     --------------     --------------     ---------------     ---------------     -----------
17648670_read-write_4KiB-8KiB_1  1       read   10.134.0.33  5553.8     22215           0.0         0                553.0              1318.9             0.0                 0.0                 43
17648670_read-write_4KiB-8KiB_1  1       read   10.132.2.50  2854.5     11418           0.0         0                995.3              3096.6             0.0                 0.0                 85
17648670_read-write_4KiB-8KiB_1  2       read   10.134.0.33  5630.9     22523           0.0         0                561.2              1269.8             0.0                 0.0                 43
17648670_read-write_4KiB-8KiB_1  2       read   10.132.2.50  2899.0     11596           0.0         0                987.1              3129.3             0.0                 0.0                 84
17648670_read-write_4KiB-8KiB_1  3       write  10.134.0.33  0.0        0               3179.8      12719            0.0                0.0                970.8               2277.4              76
17648670_read-write_4KiB-8KiB_1  3       write  10.132.2.50  0.0        0               1678.9      6715             0.0                0.0                1679.4              5668.9              145
17648670_read-write_4KiB-8KiB_1  4       write  10.134.0.33  0.0        0               3168.8      12675            0.0                0.0                995.3               2211.8              77
17648670_read-write_4KiB-8KiB_1  4       write  10.132.2.50  0.0        0               1598.5      6394             0.0                0.0                1744.9              5931.0              152
17648670_read-write_4KiB-8KiB_1  5       read   10.134.0.33  3645.8     29166           0.0         0                806.9              2572.3             0.0                 0.0                 33
17648670_read-write_4KiB-8KiB_1  5       read   10.132.2.50  1733.6     13868           0.0         0                1548.3             6062.1             0.0                 0.0                 70
17648670_read-write_4KiB-8KiB_1  6       read   10.134.0.33  3748.2     29985           0.0         0                790.5              2441.2             0.0                 0.0                 32
17648670_read-write_4KiB-8KiB_1  6       read   10.132.2.50  1657.2     13257           0.0         0                1613.8             6258.7             0.0                 0.0                 73
17648670_read-write_4KiB-8KiB_1  7       write  10.134.0.33  0.0        0               2936.8      23494            0.0                0.0                1089.5              2408.4              41
17648670_read-write_4KiB-8KiB_1  7       write  10.132.2.50  0.0        0               1434.8      11478            0.0                0.0                2007.0              6717.4              85
17648670_read-write_4KiB-8KiB_1  8       write  10.134.0.33  0.0        0               2729.7      21837            0.0                0.0                1138.7              2703.4              44
17648670_read-write_4KiB-8KiB_1  8       write  10.132.2.50  0.0        0               1465.8      11726            0.0                0.0                1990.7              6324.2              83
17648670_read-write_4KiB-8KiB_1  9       read   10.134.0.33  4811.7     19246           0.0         0                634.9              1712.1             0.0                 0.0                 50
17648670_read-write_4KiB-8KiB_1  9       read   10.134.0.33  4952.2     19808           0.0         0                602.1              1548.3             0.0                 0.0                 49
17648670_read-write_4KiB-8KiB_1  9       read   10.132.2.50  2027.7     8110            0.0         0                1286.1             5144.6             0.0                 0.0                 120
17648670_read-write_4KiB-8KiB_1  9       read   10.132.2.50  2057.3     8229            0.0         0                1253.4             5013.5             0.0                 0.0                 118
17648670_read-write_4KiB-8KiB_1  10      read   10.134.0.33  5373.4     21493           0.0         0                585.7              1368.1             0.0                 0.0                 45
17648670_read-write_4KiB-8KiB_1  10      read   10.134.0.33  5634.8     22539           0.0         0                561.2              1318.9             0.0                 0.0                 43
17648670_read-write_4KiB-8KiB_1  10      read   10.132.2.50  2239.9     8959            0.0         0                1187.8             4685.8             0.0                 0.0                 108
17648670_read-write_4KiB-8KiB_1  10      read   10.132.2.50  2276.4     9105            0.0         0                1171.5             4685.8             0.0                 0.0                 107
17648670_read-write_4KiB-8KiB_1  11      write  10.134.0.33  0.0        0               3186.7      12746            0.0                0.0                995.3               2179.1              76
17648670_read-write_4KiB-8KiB_1  11      write  10.134.0.33  0.0        0               3140.5      12562            0.0                0.0                1011.7              2310.1              77
17648670_read-write_4KiB-8KiB_1  11      write  10.132.2.50  0.0        0               1706.7      6826             0.0                0.0                1679.4              5603.3              143
17648670_read-write_4KiB-8KiB_1  11      write  10.132.2.50  0.0        0               1712.3      6849             0.0                0.0                1679.4              5537.8              142
17648670_read-write_4KiB-8KiB_1  12      write  10.134.0.33  0.0        0               3377.1      13508            0.0                0.0                938.0               2039.8              72
17648670_read-write_4KiB-8KiB_1  12      write  10.134.0.33  0.0        0               3400.5      13601            0.0                0.0                938.0               2039.8              71
17648670_read-write_4KiB-8KiB_1  12      write  10.132.2.50  0.0        0               1895.1      7580             0.0                0.0                1548.3              4882.4              128
17648670_read-write_4KiB-8KiB_1  12      write  10.132.2.50  0.0        0               1891.8      7567             0.0                0.0                1564.7              4948.0              129
17648670_read-write_4KiB-8KiB_1  13      read   10.134.0.33  4505.4     36043           0.0         0                741.4              1531.9             0.0                 0.0                 27
17648670_read-write_4KiB-8KiB_1  13      read   10.134.0.33  4537.4     36299           0.0         0                733.2              1531.9             0.0                 0.0                 26
17648670_read-write_4KiB-8KiB_1  13      read   10.132.2.50  1831.5     14651           0.0         0                1548.3             5341.2             0.0                 0.0                 66
17648670_read-write_4KiB-8KiB_1  13      read   10.132.2.50  1840.6     14724           0.0         0                1548.3             5341.2             0.0                 0.0                 66
17648670_read-write_4KiB-8KiB_1  14      read   10.134.0.33  4664.1     37313           0.0         0                725.0              1433.6             0.0                 0.0                 26
17648670_read-write_4KiB-8KiB_1  14      read   10.134.0.33  4756.5     38051           0.0         0                716.8              1400.8             0.0                 0.0                 25
17648670_read-write_4KiB-8KiB_1  14      read   10.132.2.50  1956.5     15652           0.0         0                1466.4             4948.0             0.0                 0.0                 62
17648670_read-write_4KiB-8KiB_1  14      read   10.132.2.50  1929.5     15436           0.0         0                1482.8             5013.5             0.0                 0.0                 63
17648670_read-write_4KiB-8KiB_1  15      write  10.134.0.33  0.0        0               3367.3      26938            0.0                0.0                1011.7              1974.3              36
17648670_read-write_4KiB-8KiB_1  15      write  10.134.0.33  0.0        0               3409.6      27276            0.0                0.0                1011.7              1925.1              35
17648670_read-write_4KiB-8KiB_1  15      write  10.132.2.50  0.0        0               1576.1      12609            0.0                0.0                1876.0              5799.9              77
17648670_read-write_4KiB-8KiB_1  15      write  10.132.2.50  0.0        0               1586.0      12688            0.0                0.0                1892.4              5734.4              76
17648670_read-write_4KiB-8KiB_1  16      write  10.134.0.33  0.0        0               3297.8      26382            0.0                0.0                1019.9              2039.8              37
17648670_read-write_4KiB-8KiB_1  16      write  10.134.0.33  0.0        0               3278.8      26230            0.0                0.0                1028.1              2039.8              37
17648670_read-write_4KiB-8KiB_1  16      write  10.132.2.50  0.0        0               1582.9      12662            0.0                0.0                1908.7              5734.4              77
17648670_read-write_4KiB-8KiB_1  16      write  10.132.2.50  0.0        0               1594.2      12753            0.0                0.0                1908.7              5603.3              76

Results exported to: fio-results-17648670_read-write_4KiB-8KiB_1-20251204-125133.csv
2025/12/04 12:51:33 Benchmark completed successfully!</pre>
</div>
</div>
<div class="paragraph">
<p>For convenience, let&#8217;s present the 4 first results in table format:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6924%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Test ID</th>
<th class="tableblock halign-left valign-top">Sample</th>
<th class="tableblock halign-left valign-top">Job</th>
<th class="tableblock halign-left valign-top">Hostname</th>
<th class="tableblock halign-left valign-top">Read IOPS</th>
<th class="tableblock halign-left valign-top">Read BW (KB/s)</th>
<th class="tableblock halign-left valign-top">Write IOPS</th>
<th class="tableblock halign-left valign-top">Write BW (KB/s)</th>
<th class="tableblock halign-left valign-top">Read Lat P50 (μs)</th>
<th class="tableblock halign-left valign-top">Read Lat P95 (μs)</th>
<th class="tableblock halign-left valign-top">Write Lat P50 (μs)</th>
<th class="tableblock halign-left valign-top">Write Lat P95 (μs)</th>
<th class="tableblock halign-left valign-top">Runtime (s)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17648670_read-write_4KiB-8KiB_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.134.0.33</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5553.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">22215</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">553.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1318.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">43</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17648670_read-write_4KiB-8KiB_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.132.2.50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2854.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11418</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">995.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3096.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">85</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17648670_read-write_4KiB-8KiB_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.134.0.33</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5630.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">22523</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">561.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1269.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">43</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17648670_read-write_4KiB-8KiB_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.132.2.50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2899.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11596</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">987.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3129.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">84</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17648670_read-write_4KiB-8KiB_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.134.0.33</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3179.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12719</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">970.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2277.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">76</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17648670_read-write_4KiB-8KiB_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.132.2.50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1678.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6715</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1679.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5668.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">145</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17648670_read-write_4KiB-8KiB_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.134.0.33</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3168.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12675</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">995.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2211.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">77</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">17648670_read-write_4KiB-8KiB_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.132.2.50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1598.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6394</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1744.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5931.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">152</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As we can see from the output, k8s-io run 32 tests iterating through the number of servers, samples, jobs, block sizes and number of jobs. K8s-io automatically captured and parsed the results, displaying them in both a formatted table and exporting to CSV for further analysis.</p>
</div>
<div class="paragraph">
<p>Some of the <strong>key metrics captured</strong> include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Sample</strong>: Sample/iteration number for multi-sample benchmarks (starts from 1)</p>
</li>
<li>
<p><strong>IOPs</strong>: Input/Output operations per second for read and write operations</p>
</li>
<li>
<p><strong>Bandwidth</strong>: Data transfer rate in KB/s</p>
</li>
<li>
<p><strong>Latency percentiles</strong>: P50 (median) and P95 latency in microseconds</p>
</li>
<li>
<p><strong>Runtime</strong>: Actual test duration in seconds</p>
</li>
<li>
<p><strong>Hostname</strong>: Worker node where each test client ran</p>
</li>
<li>
<p><strong>Timestamp</strong>: When the results were captured</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_storage_classes"><a class="anchor" href="#_storage_classes"></a>Storage classes</h3>
<div class="paragraph">
<p>For FIO benchmarks, is it possible to specify a storage class to test different storage types. Let&#8217;s see what storage classes we have available in the cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get storageclass</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>NAME                                             PROVISIONER                             RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE
ocs-external-storagecluster-ceph-rbd (default)   openshift-storage.rbd.csi.ceph.com      Delete          Immediate           true                   135m
ocs-external-storagecluster-cephfs               openshift-storage.cephfs.csi.ceph.com   Delete          Immediate           true                   135m
openshift-storage.noobaa.io                      openshift-storage.noobaa.io/obc         Delete          Immediate           false                  133m</pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s point to the default storage class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cat &gt; config-fio-sc.yaml &lt;&lt;EOF
namespace: "benchmark-fio"
workload:
  name: "fio"
  args:
    kind: "pod"
    servers: 1
    samples: 1
    jobs: ["read"]
    bs: ["4KiB"]
    numjobs: [1]
    filesize: "1G"
    storageclass: "ocs-external-storagecluster-ceph-rbd"
    storagesize: "1Gi"
    prefill: true
EOF</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note we introduced a couple new parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>storageclass</code>: To use a specific storage class</p>
</li>
<li>
<p><code>storagesize</code>: Persistent Volume Clain (PVC) size</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s run the test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">k8s-io -config config-fio-sc.yaml</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>2025/12/04 13:32:26 Starting K8s-IO benchmark tool...
2025/12/04 13:32:26 Loaded configuration for workload: fio
2025/12/04 13:32:26 Created fio workload
2025/12/04 13:32:26 Starting fio benchmark...
2025/12/04 13:32:26 Starting FIO distributed benchmark execution...
2025/12/04 13:32:26 Deploying infrastructure...
2025/12/04 13:32:26 Waiting for 1 FIO servers to be ready...
2025/12/04 13:32:26 Waiting for pods: 0/1 ready (selector: app=fio-benchmark-17648731)
2025/12/04 13:32:41 All 1 servers are ready
2025/12/04 13:32:41 Creating hosts configmap...
2025/12/04 13:32:41 Job fio-check-17648731 still running (succeeded: 0, failed: 0, active: 1)
2025/12/04 13:33:41 Job fio-check-17648731 completed successfully
2025/12/04 13:33:41 Running prefill job...
2025/12/04 13:33:41 Job fio-prefill-17648731 still running (succeeded: 0, failed: 0, active: 0)
2025/12/04 13:34:41 Job fio-prefill-17648731 completed successfully
2025/12/04 13:34:41 Prefill completed successfully
2025/12/04 13:34:41 Starting benchmark client...
2025/12/04 13:34:42 Benchmark client started
2025/12/04 13:34:42 Waiting for benchmark to complete...
2025/12/04 13:34:42 Job fio-client-17648731 still running (succeeded: 0, failed: 0, active: 0)
2025/12/04 13:35:42 Job fio-client-17648731 still running (succeeded: 0, failed: 0, active: 1)
2025/12/04 13:36:42 Job fio-client-17648731 completed successfully
2025/12/04 13:36:42 Capturing benchmark results...
Found 1 FIO result(s)

=== FIO Benchmark Results ===
Test ID               Sample  Job   Hostname     Read IOPS  Read BW (KB/s)  Write IOPS  Write BW (KB/s)  Read Lat P50 (μs)  Read Lat P95 (μs)  Write Lat P50 (μs)  Write Lat P95 (μs)  Runtime (s)
-------               ------  ---   --------     ---------  -----------     ----------  ------------     --------------     --------------     ---------------     ---------------     -----------
17648731_read_4KiB_1  1       read  10.134.0.38  7753.2     31012           0.0         0                399.4              962.6              0.0                 0.0                 31

Results exported to: fio-results-17648731_read_4KiB_1-20251204-133642.csv
2025/12/04 13:36:42 Benchmark completed successfully!</pre>
</div>
</div>
<div class="paragraph">
<p>We can see the test left the Persistent Volume and the pods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get pvc</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>NAME                   STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS                           VOLUMEATTRIBUTESCLASS   AGE
fio-claim-1-17648731   Bound    pvc-138920d0-1ca7-4d7e-93d2-ad5513d17500   1Gi        RWO            ocs-external-storagecluster-ceph-rbd   &lt;unset&gt;                 12m</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get pods -n benchmark-fio</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>NAME                              READY   STATUS      RESTARTS   AGE
fio-check-17648670-srjlk          0/1     Completed   0          120m
fio-check-17648731-z8fmv          0/1     Completed   0          18m
fio-client-17648670-wnjqf         0/1     Completed   0          116m
fio-client-17648731-z79ng         0/1     Completed   0          16m
fio-prefill-17648670-b5xg8        0/1     Completed   0          117m
fio-prefill-17648731-jbmvr        0/1     Completed   0          17m
fio-server-1-benchmark-17648670   1/1     Running     0          120m
fio-server-1-benchmark-17648731   1/1     Running     0          18m
fio-server-2-benchmark-17648670   1/1     Running     0          120m</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cleanup"><a class="anchor" href="#_cleanup"></a>Cleanup</h3>
<div class="paragraph">
<p>To clean up the resources after the benchmarking:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">k8s-io -config config-fio.yaml -cleanup
k8s-io -config config-fio-sc.yaml -cleanup</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_indexing_the_results"><a class="anchor" href="#_indexing_the_results"></a>Indexing the results</h3>
<div class="paragraph">
<p>k8s-io can also index the results in a remote ElasticSearch/OpenSearch instance. Let&#8217;s configure Prometheus for metric collection and ElasticSearch for indexing the results:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get ElasticSearch password:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ES_PASSWORD=$(oc get secret elasticsearch-es-elastic-user -n openshift-logging -o jsonpath='{.data.elastic}' | base64 -d)</code></pre>
</div>
</div>
</li>
<li>
<p>Get ElasticSearch password:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ES_PASSWORD=$(oc get secret elasticsearch-es-elastic-user -n openshift-logging -o jsonpath='{.data.elastic}' | base64 -d)</code></pre>
</div>
</div>
</li>
<li>
<p>Validate ElasticSearch authentication:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -k $ES_INSTANCE</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "name" : "elasticsearch-es-default-0",
  "cluster_name" : "elasticsearch",
  "cluster_uuid" : "gfP33bmwQ82UMWI2btj2OQ",
  "version" : {
    "number" : "8.15.0",
    "build_flavor" : "default",
    "build_type" : "docker",
    "build_hash" : "1a77947f34deddb41af25e6f0ddb8e830159c179",
    "build_date" : "2024-08-05T10:05:34.233336849Z",
    "build_snapshot" : false,
    "lucene_version" : "9.11.1",
    "minimum_wire_compatibility_version" : "7.17.0",
    "minimum_index_compatibility_version" : "7.0.0"
  },
  "tagline" : "You Know, for Search"
}</code></pre>
</div>
</div>
</li>
<li>
<p>Create the configuration file with the corresponding <code>prometheus</code> and <code>elasticsearch</code> sections:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cat &gt; config-fio-es.yaml &lt;&lt;EOF
namespace: "benchmark-fio"
workload:
name: "fio"
args:
  kind: "pod"
  servers: 1
  samples: 1
  jobs: ["read"]
  bs: ["4KiB"]
  numjobs: [1]
  filesize: "1G"
  storageclass: "ocs-external-storagecluster-ceph-rbd"
  storagesize: "1Gi"
  prefill: true
prometheus:
url: "http://prometheus.monitoring.svc.cluster.local:9091"
elasticsearch:
url: "$ES_INSTANCE"
index_name: "k8s-io"
verify_cert: false
parallel: true
EOF</code></pre>
</div>
</div>
</li>
<li>
<p>Run the test:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">k8s-io -config config-fio-es.yaml</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see_also"><a class="anchor" href="#_see_also"></a>See also</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you are interested in database performance benchmarking, take a look at some <a href="https://github.com/jtaleric/k8s-io/tree/main?tab=readme-ov-file#hammerdb-configuration-example">HammerDB configuration examples</a>.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html">Storage benchmarking</a></span>
  <span class="next"><a href="../ch7-regression/index.html">Automatic performance regression analysis</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
